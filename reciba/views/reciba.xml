<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record model="ir.ui.view" id="reciba_ticket_form_view">
            <field name="name">reciba.ticket.form</field>
            <field name="model">reciba.ticket</field>
            <field name="arch" type="xml">
                <form string="Reciba Form">
                    <header>
                        <button name="confirm_reciba" type="object" states="draft" string="Confirmar" />
                        <button name="cancel_reciba" type="object" states="draft" string="Cancelar" />
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,invoiced,cancel" />
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="name" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                                <field name="date" readonly="1" />
                                <field name="partner_id" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                                <field name="product_id" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            </group>
                        </group>
                        <group>
                            <field name="quality_id" string="Norma de calidad"
                                attrs="{'readonly':[('state', '!=', 'draft')]}" />
                        </group>
                        <group>
                            <group>
                                <field name="humidity" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                                <field name="impurity" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            </group>
                            <group>
                                <field name="humidity_discount" />
                                <field name="impurity_discount" />
                            </group>
                            <field name="params_id" attrs="{'readonly':[('state', '!=', 'draft')]}">
                                <tree editable="bottom">
                                    <field name="quality_params_id" readonly="True" force_save="1" />
                                    <field name="max_value" />
                                    <field name="value" />
                                </tree>
                            </field>
                        </group>
                        <group>
                            <field name="driver" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            <field name="weigher" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            <field name="plate_tracto" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            <field name="plate_trailer" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                        </group>

                        <group>
                            <field name="reception"
                                attrs="{'readonly':['|',('state', '=', 'cancel'),('state', '=', 'invoiced')]}" />
                        </group>

                        <group>
                            <group>
                                <field name="location_id" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            </group>
                            <group>
                                <field name="location_date" />
                            </group>
                        </group>
                        <group>
                            <group>
                                <field name="gross_weight" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                                <field name="tare_weight" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                                <field name="net_weight" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                            </group>
                            <group>
                                <field name="gross_date" />
                                <field name="tare_date" />
                                <field name="net_date" />
                            </group>
                        </group>
                        <group>
                            <group>
                                <field name="humidity_total_discount" />
                                <field name="impurity_total_discount" />
                                <field name="discount" />
                                <field name="total_weight" />
                            </group>
                            <group>
                                <field name="price"
                                    attrs="{'readony':['|',('state', '=', 'cancel'),('state', '=', 'invoiced')], 'required':[('reception', '=', 'price')], 'invisible':[('reception', '=', 'priceless')]}" />
                                <field name="currency_id" attrs="{'readonly':[('state', '!=', 'draft')]}" />
                                <field name="sub" />
                                <field name="total" />
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>



        <record model="ir.ui.view" id="reciba_ticket_tree_view">
            <field name="name">reciba.ticket.tree</field>
            <field name="model">reciba.ticket</field>
            <field name="arch" type="xml">
                <tree string="Reciba Tree">
                    <field name="name" />
                    <field name="partner_id" />
                    <field name="product_id" />
                    <field name="net_weight" />
                    <field name="discount" />
                    <field name="price" />
                    <field name="quality_id" />
                    <field name="reception" />
                    <field name="state" />
                    <field name="location_id" />
                </tree>
            </field>
        </record>

        <record model="ir.actions.act_window" id="reciba_ticket_action">
            <field name="name">Boletas</field>
            <field name="res_model">reciba.ticket</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">Create the first ticket
                </p>
            </field>
        </record>



        <!-- Top menu item -->
        <menuitem name="Reciba" id="menu_reciba_root" sequence="40" />

        <menuitem id="inventory_menu" name="Inventario" parent="menu_reciba_root" sequence="1" />

        <menuitem id="inventory_ticket_menu" name="Boletas" parent="inventory_menu" action="reciba_ticket_action"
            sequence="1" />


        <record model="ir.ui.view" id="reciba_quality_form_view">
            <field name="name">reciba.quality.form</field>
            <field name="model">reciba.quality</field>
            <field name="arch" type="xml">
                <form string="Reciba Form">
                    <sheet>
                        <group>
                            <field name="name" />
                            <field name="product_id" />
                        </group>
                        <group>
                            <field name="params">
                                <tree string="Quality Tree" editable="bottom">
                                    <field name="name" />
                                    <field name="value" />
                                </tree>
                            </field>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="reciba_quality_tree_view">
            <field name="name">reciba.quality.tree</field>
            <field name="model">reciba.quality</field>
            <field name="arch" type="xml">
                <tree string="Quality Tree">
                    <field name="name" />
                    <field name="product_id" />
                </tree>
            </field>
        </record>

        <record model="ir.actions.act_window" id="reciba_quality_action">
            <field name="name">Parametros de calidad</field>
            <field name="res_model">reciba.quality</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">Create the first Param
                </p>
            </field>
        </record>

        <menuitem id="inventory_quality_menu" name="Parametros de calidad" parent="inventory_menu"
            action="reciba_quality_action" sequence="2" />

    </data>


    <template id="report_ticket">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t t-foreach="docs" t-as="ticket">
                    <br />
                    <div style="width: 100%;">
                        <table style="width: 100%; text-align: left;">
                            <tr>
                                <th
                                    style="width: 20%; padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    Proveedor</th>
                                <td
                                    style="width: 30%;  padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    <t t-esc="ticket['ticket'].partner_id.name" />
                                </td>
                                <td style="width: 50%;" rowspan="7">
                                    <div
                                        style="width: 100%; height: 350px; border: 1px rgb(55, 55, 182) solid; border-radius: 10px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th
                                    style="width: 20%; padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    Producto</th>
                                <td
                                    style="width: 30%;  padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    <t t-esc="ticket['ticket'].product_id.name" />
                                </td>
                            </tr>
                            <tr>
                                <th
                                    style="width: 20%; padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    Chofer</th>
                                <td
                                    style="width: 30%;  padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    <t t-esc="ticket['ticket'].driver" />
                                </td>
                            </tr>
                            <tr>
                                <th
                                    style="width: 20%; padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    Placas tracto</th>
                                <td
                                    style="width: 30%;  padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    <t t-esc="ticket['ticket'].plate_tracto" />
                                </td>
                            </tr>
                            <tr>
                                <th
                                    style="width: 20%; padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    Placas remolque</th>
                                <td
                                    style="width: 30%;  padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    <t t-esc="ticket['ticket'].plate_trailer" />
                                </td>
                            </tr>
                            <tr>
                                <th
                                    style="width: 20%; padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    Pesador</th>
                                <td
                                    style="width: 30%;  padding-top: 5px; padding-bottom: 5px; border-bottom: solid 1px black;">
                                    <t t-esc="ticket['ticket'].weigher" />
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                            </tr>
                        </table>
                    </div>

                    <br />
                    <br />
                    <label>Parametros de calidad</label>
                    <br />

                    <div style="display: flex; padding-top: 20px; width: 100%;">
                        <table style="width: 100%;">
                            <tr>
                                <td style="width: 50%;">
                                    <table style="width: 100%; text-align: left;">
                                        <tr t-foreach="ticket['ticket'].params_id" t-as="param">
                                            <th style="width: 30%;">
                                                <t t-esc="param.quality_params_id.name" />
                                            </th>
                                            <td style="width: 15%; border-bottom: black 1px solid;">
                                                <t t-esc="param.value" />
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="width: 50%;">
                                    <table style="width: 100%; text-align: left;">
                                        <tr>
                                            <th style="width: 30%;">Humedad</th>
                                            <td style="width: 15%; border-bottom: black 1px solid;">
                                                <t t-esc="ticket['ticket'].humidity" /> %</td>
                                        </tr>
                                        <tr>
                                            <th style="width: 30%;">Impureza</th>
                                            <td style="width: 15%; border-bottom: black 1px solid;">
                                                <t t-esc="ticket['ticket'].impurity" /> %</td>
                                        </tr>
                                        <tr>
                                            <th style="width: 30%;">Peso neto analizado</th>
                                            <td style="width: 15%; border-bottom: black 1px solid;">
                                                <t t-esc="ticket['ticket'].total_weight" /> Kg</td>
                                        </tr>
                                        <tr>
                                            <th style="width: 35%;">Precio</th>
                                            <t t-if="ticket['ticket'].price">
                                                <td style="width: 15%; border-bottom: black 1px solid;">
                                                    $
                                                    <t t-esc="ticket['ticket'].total_weight" />
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="width: 15%; border-bottom: black 1px solid;">
                                                    Por asignar</td>
                                            </t>

                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <div style="width: 100%; padding-top: 150px;">
                        <table style="width: 100%; text-align: center;">
                            <tr>
                                <th style="width: 33%; ">
                                    <div
                                        style="width: 94%; margin-left: 3%; margin-right: 3%; border-top: black 1px solid;">
                                        Analista</div>
                                </th>
                                <th style="width: 33%; ">
                                    <div
                                        style="width: 94%; margin-left: 3%; margin-right: 3%; border-top: black 1px solid;">
                                        Proveedor/Chofer</div>
                                </th>
                                <th style="width: 33%; ">
                                    <div
                                        style="width: 94%; margin-left: 3%; margin-right: 3%; border-top: black 1px solid;">
                                        Sello</div>
                                </th>
                            </tr>
                        </table>
                    </div>

                </t>
            </t>
        </t>
    </template>

    <report id="report_reciba_custom" string="Imprimir boleta" model="reciba.ticket" report_type="qweb-html"
        name="reciba.report_ticket" />


</odoo>